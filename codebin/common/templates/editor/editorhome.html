{% extends "home/home.html" %}
{% load htmltags %}

{% block staticfiles %}
    {% load staticfiles %}
    <link rel = "stylesheet" href = "{% static 'css/editor.css' %}" type = "text/css"/>
    <script src = "{% static 'javascript/ace/ace.js' %}" type = "text/javascript" charset = "utf-8"></script>
    <script src = "{% static 'javascript/skulpt/skulpt.min.js' %}" type = "text/javascript"></script>
    <script src = "{% static 'javascript/skulpt/skulpt-stdlib.js' %}" type = "text/javascript"></script>
    <script src = "{% static 'javascript/editor/editor.js' %}" type = "text/javascript"></script>
    <script src = "{% static 'javascript/editor/acefunctions.js' %}" type = "text/javascript"></script>
    <script type = "text/javascript">
    function SaveCode()
    {
        var code = editor.getSession().getValue();
        var message = "projecthash={{projectdata.projectHash}}&code=" + code;
        func = function(ajaxresponse)
        {
            document.getElementById("console").innerHTML = ajaxresponse;
        }
        var headers = [["Content-Type","application/x-www-form-urlencoded"],["X-CSRFToken", "{{ csrf_token }}"]];
        SendAjaxRequest(func, true, "{% url 'editor:savecode' %}", headers, message);
    }
    </script>
{% endblock %}

{% block body %}
    <button type = "button" onclick = "runit()" class = "controlbuttons">
        Run
    </button>
    <button type = "button" onclick = "SaveCode()" class = "controlbuttons">
        Save
    </button>
    <div id = "editor"></div>
    <pre id = "console"></pre>
    <pre id = "output"></pre>
    <canvas id = "mycanvas"></mycanvas>
    <script>
        var editor = ace.edit("editor");
        editor.setTheme("ace/theme/monokai");
        editor.getSession().setMode("ace/mode/python");
        editor.insert("{% html_decode projectdata.projectCode %}");
    </script>
{% endblock %}
